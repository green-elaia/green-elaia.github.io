---
layout: post
title: 동적 연결 라이브러리 (Dynamic Link Library)
category: Python
use_math: true
tag: [dll]
show_sidebar: false
---



## Dynamic Link Library (DLL)



## 동적 연결 라이브러리 (Dynamic Link Library, DLL)

DLL은 여러 프로그램에서 동시에 사용할 수 있는 코드와 데이터를 포함하는 라이브러리이다.

메모장, 그림판 등 윈도우용 프로그램에서 '파일열기' 기능을 실행하면 동일한 모습의 파일열기 창이 화면에 뜨는 것을 볼 수 있는데. 이것은 각 프로그램이 윈도우에서 제공하는 DLL를 사용하기 때문이다.

즉, Windows 운영 체제의 기능은 대부분 DLL을 통해 제공되고. Windows OS용 프로그램은 이 DLL를 활용하여 프로그램의 기능을 구현 및 제공할 수 있다.

예를 들어, Windows OS에서 Comdlg32 DLL은 일반적인 대화 상자 관련 기능을 수행한다. 그래서 각 프로그램은 이 DLL에 포함된 기능을 사용해 **열기** 대화 상자를 구현할 수 있다.

<br/>

##### Static Link Library  vs  Dynamic Link Library

라이브러리가 어느 시점에 메인 프로그램과 연결(link)되느냐에 따라 static link library와 dynamic link library로 나뉜다.

**static link library**: 컴파일 시점에 라이브러리가 링커에 의해 연결되어 실행파일의 일부분이 된다. 필요한 함수의 코드가 메인 프로그램 코드에 붙여져 실행파일이 만들어진다는 의미이다. 프로그램이 실행된 후에는 처리시간이 빠르고, 실행파일 안에 모든 관련 코드가 존재하므로 실행파일 하나만 있어도 실행이 가능하다.

**dynamic link library**: 실행파일에서 해당 라이브러리의 기능을 사용할 때에만 외부 라이브러리 파일을 참조하여 기능을 호출한다. static link library와 다르게 컴파일 시점에서 실행파일에 함수를 복사해 넣지 않고, 함수의 위치정보만 갖도록 해 해당 함수를 호출할 수 있게 한다.

<br/>

##### DLL 이점

- 하나의 코드를 여러 프로그램이 동시에 사용하기 때문에 적은 메모리 리소스를 사용하게 된다.
- static link library로 만들어진 실행파일보다 실행파일의 크기가 작아지기 때문에 사용하는 디스크 공간을 줄일 수 있다.

- 프로그램 실행 시 프로그램 로딩시간이 단축된다.
- DLL을 사용하면 모듈식 프로그램을 효율적으로 개발할 수 있다. (여러 언어 버전이 필요한 프로그램, 모듈식 아키텍처가 필요한 프로그램 등)
- DLL 내의 함수를 업데이트 하거나 수정하여 DLL을 배포하고 설치할 경우, 프로그램을 DLL과 다시 연결(link)하지 않아도 되므로 유지보수에 용이하다.
- 여러 프로그램이 같은 DLL를 사용하는 경우 해당 DLL를 업데이트 하면, 모든 프로그램에 업데이트가 적용된다.
- 프로그래머들의 분업이 용이해지며 재사용성도 향상된다.
- 메인 프로그램의 코드 양이 적어지므로 디버깅이 용이해진다.

<br/>

##### DLL 사용시 주의점

DLL 파일을 함부로 이동시키면 프로그램이 정상적으로 작동하지 않을 수 있으니 조심해야 한다. 특히 windows의 system32 폴더의 DLL 파일은 windows OS의 기능과 관련된 DLL 파일이므로 더욱 조심해야 한다.

프로그램이 DLL을 사용할 경우, DLL 종속성에 문제가 생겨 프로그램이 실행되지 않을 수 있다. DLL 종속성은 프로그램이나 DLL이 다른 DLL 내의 함수를 사용하는 경우에 발생한다.

다음의 경우는 DLL 충돌이 생길 수 있는 상황이며, 이전 버전과의 호환성이 적용되지 않으면 프로그램이 실행되지 않을 수 있다.

- 종속 DLL을 새 버전으로 업그레이드하는 경우
- 종속 DLL을 수정하는 경우
- 종속 DLL을 이전 버전으로 덮어쓰는 경우
- 종속 DLL을 컴퓨터에서 제거하는 경우

